<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LION_Estate Admin Panel</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    :root {
      --primary-color: #2c3e50;
      --secondary-color: #3498db;
      --success-color: #2ecc71;
      --warning-color: #f39c12;
      --danger-color: #e74c3c;
      --light-color: #ecf0f1;
      --dark-color: #34495e;
      --text-color: #2c3e50;
      --border-color: #ddd;
    }

    body {
      font-family: Arial, sans-serif;
      background-color: #f5f5f5;
      color: var(--text-color);
    }

    /* Sidebar */
    .sidebar {
      background-color: var(--primary-color);
      color: white;
      height: 100vh;
      width: 250px;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 1000;
      transition: all 0.3s;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    .sidebar.collapsed {
      width: 70px;
    }

    .sidebar-brand {
      padding: 15px;
      text-align: center;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .logo-container {
      margin-bottom: 15px;
      text-align: center;
    }

    .logo {
      max-width: 80px;
      height: auto;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
      transition: all 0.3s;
    }

    .logo:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }

    .sidebar.collapsed .logo {
      max-width: 40px;
    }

    .sidebar.collapsed .logo-container {
      margin-bottom: 10px;
    }

    .brand-text {
      color: white;
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 5px;
    }

    .brand-subtitle {
      color: rgba(255, 255, 255, 0.7);
      font-size: 12px;
    }

    .sidebar.collapsed .brand-text,
    .sidebar.collapsed .brand-subtitle {
      display: none;
    }

    .nav-link {
      color: rgba(255, 255, 255, 0.8);
      padding: 12px 15px;
      display: flex;
      align-items: center;
      transition: all 0.3s;
    }

    .nav-link:hover {
      background-color: rgba(255, 255, 255, 0.1);
      color: white;
    }

    .nav-link.active {
      background-color: var(--secondary-color);
      color: white;
    }

    .nav-link i {
      width: 20px;
      margin-right: 10px;
      text-align: center;
    }

    .sidebar.collapsed .nav-text {
      display: none;
    }

    /* Main Content */
    .main-content {
      margin-left: 250px;
      transition: all 0.3s;
      min-height: 100vh;
    }

    .main-content.expanded {
      margin-left: 70px;
    }

    /* Top Navigation */
    .top-nav {
      background-color: white;
      border-bottom: 1px solid var(--border-color);
      padding: 15px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    }

    /* Content Area */
    .content-area {
      padding: 20px;
    }

    /* Cards */
    .card {
      border: 1px solid var(--border-color);
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
      margin-bottom: 20px;
    }

    .card-header {
      background-color: var(--primary-color);
      color: white;
      padding: 15px;
      font-weight: 600;
    }

    .card-body {
      padding: 20px;
    }

    /* Stats Cards */
    .stats-card {
      background-color: white;
      border-radius: 5px;
      padding: 20px;
      text-align: center;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
      height: 100%;
    }

    .stats-card.primary {
      border-top: 4px solid var(--primary-color);
    }

    .stats-card.success {
      border-top: 4px solid var(--success-color);
    }

    .stats-card.warning {
      border-top: 4px solid var(--warning-color);
    }

    .stats-card.danger {
      border-top: 4px solid var(--danger-color);
    }

    .stats-icon {
      font-size: 2rem;
      margin-bottom: 10px;
      color: var(--primary-color);
    }

    .stats-card.success .stats-icon {
      color: var(--success-color);
    }

    .stats-card.warning .stats-icon {
      color: var(--warning-color);
    }

    .stats-card.danger .stats-icon {
      color: var(--danger-color);
    }

    .stats-number {
      font-size: 1.8rem;
      font-weight: bold;
      margin-bottom: 5px;
    }

    .stats-label {
      color: #777;
      font-size: 0.9rem;
    }

    /* Tables */
    .table th {
      background-color: var(--primary-color);
      color: white;
    }

    .table-container {
      background-color: white;
      border-radius: 5px;
      overflow: hidden;
    }

    /* Buttons */
    .btn-primary {
      background-color: var(--primary-color);
      border-color: var(--primary-color);
    }

    .btn-success {
      background-color: var(--success-color);
      border-color: var(--success-color);
    }

    .btn-warning {
      background-color: var(--warning-color);
      border-color: var(--warning-color);
    }

    .btn-danger {
      background-color: var(--danger-color);
      border-color: var(--danger-color);
    }

    /* Forms */
    .form-control {
      border: 1px solid var(--border-color);
      border-radius: 4px;
      padding: 8px 12px;
    }

    .form-control:focus {
      border-color: var(--secondary-color);
      box-shadow: 0 0 0 0.2rem rgba(52, 152, 219, 0.25);
    }

    /* Badges */
    .badge.bg-primary {
      background-color: var(--primary-color) !important;
    }

    .badge.bg-success {
      background-color: var(--success-color) !important;
    }

    .badge.bg-warning {
      background-color: var(--warning-color) !important;
    }

    .badge.bg-danger {
      background-color: var(--danger-color) !important;
    }

    /* Property Images */
    .property-image {
      width: 50px;
      height: 50px;
      object-fit: cover;
      border-radius: 4px;
    }

    /* Sections */
    .section {
      display: none;
    }

    .section.active {
      display: block;
    }

    /* Mobile Responsive */
    .sidebar-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 999;
    }

    @media (max-width: 768px) {
      .sidebar {
        transform: translateX(-100%);
        width: 250px;
      }

      .sidebar.mobile-open {
        transform: translateX(0);
      }

      .sidebar-overlay.show {
        display: block;
      }

      .main-content {
        margin-left: 0;
      }

      .main-content.expanded {
        margin-left: 0;
      }

      .content-area {
        padding: 15px;
      }

      .top-nav {
        padding: 10px 15px;
      }
    }

    /* Toast */
    .toast-container {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 9999;
    }

    .toast {
      background-color: white;
      border-radius: 4px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }
  </style>
</head>
<body>
<!-- Toast Container -->
<div class="toast-container"></div>

<!-- Sidebar Overlay for Mobile -->
<div class="sidebar-overlay" id="sidebarOverlay" onclick="closeMobileSidebar()"></div>

<!-- Sidebar -->
<nav class="sidebar" id="sidebar">
  <div class="sidebar-brand">
    <div class="logo-container">
      <img src="lion-estate-logo.jpeg" alt="LION Estate Logo" class="logo">
    </div>
    <div class="brand-text">LION_Estate</div>
    <div class="brand-subtitle">Аренда квартир по всему Ташкенту!</div>
  </div>

  <ul class="nav flex-column">
    <li class="nav-item">
      <a class="nav-link active" href="#" onclick="showSection('dashboard')">
        <i class="fas fa-tachometer-alt"></i>
        <span class="nav-text">Dashboard</span>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#" onclick="showSection('properties')">
        <i class="fas fa-building"></i>
        <span class="nav-text">Properties</span>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#" onclick="showSection('users')">
        <i class="fas fa-users"></i>
        <span class="nav-text">Users</span>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#" onclick="showSection('admins')">
        <i class="fas fa-user-shield"></i>
        <span class="nav-text">Admins</span>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#" onclick="showSection('locations')">
        <i class="fas fa-map-marker-alt"></i>
        <span class="nav-text">Locations</span>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#" onclick="showSection('ratings')">
        <i class="fas fa-star"></i>
        <span class="nav-text">Ratings</span>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#" onclick="showSection('images')">
        <i class="fas fa-images"></i>
        <span class="nav-text">Media</span>
      </a>
    </li>
  </ul>
</nav>

<!-- Main Content -->
<div class="main-content" id="mainContent">
  <!-- Top Navigation -->
  <div class="top-nav">
    <div class="d-flex justify-content-between align-items-center">
      <div class="d-flex align-items-center">
        <button class="btn btn-outline-secondary me-3 d-none d-md-block" onclick="toggleSidebar()">
          <i class="fas fa-bars"></i>
        </button>
        <button class="btn btn-outline-secondary me-3 d-md-none" onclick="toggleMobileSidebar()">
          <i class="fas fa-bars"></i>
        </button>
        <h4 class="mb-0">Admin Panel</h4>
      </div>
      <div class="dropdown">
        <button class="btn btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
          <i class="fas fa-user me-2"></i>Admin
        </button>
        <ul class="dropdown-menu">
          <li><a class="dropdown-item" href="#"><i class="fas fa-cog me-2"></i>Settings</a></li>
          <li><a class="dropdown-item" href="#"><i class="fas fa-sign-out-alt me-2"></i>Logout</a></li>
        </ul>
      </div>
    </div>
  </div>

  <div class="content-area">
    <!-- Dashboard Section -->
    <div id="dashboard" class="section active">
      <div class="row mb-4">
        <div class="col-lg-3 col-md-6 mb-3">
          <div class="stats-card primary">
            <i class="fas fa-building stats-icon"></i>
            <div class="stats-number" id="totalProperties">0</div>
            <div class="stats-label">Total Properties</div>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 mb-3">
          <div class="stats-card success">
            <i class="fas fa-users stats-icon"></i>
            <div class="stats-number" id="totalUsers">0</div>
            <div class="stats-label">Total Users</div>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 mb-3">
          <div class="stats-card warning">
            <i class="fas fa-user-shield stats-icon"></i>
            <div class="stats-number" id="totalAdmins">0</div>
            <div class="stats-label">Total Admins</div>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 mb-3">
          <div class="stats-card danger">
            <i class="fas fa-star stats-icon"></i>
            <div class="stats-number" id="avgRating">0.0</div>
            <div class="stats-label">Avg Rating</div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-lg-8 mb-4">
          <div class="card">
            <div class="card-header">
              <i class="fas fa-chart-line me-2"></i>Recent Properties
            </div>
            <div class="card-body">
              <div class="table-container">
                <table class="table table-striped">
                  <thead>
                  <tr>
                    <th>Title</th>
                    <th>Category</th>
                    <th>Price</th>
                    <th>Status</th>
                  </tr>
                  </thead>
                  <tbody id="recentPropertiesTable">
                  <!-- Dynamic content -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
        <div class="col-lg-4 mb-4">
          <div class="card">
            <div class="card-header">
              <i class="fas fa-bolt me-2"></i>Quick Actions
            </div>
            <div class="card-body">
              <div class="d-grid gap-2">
                <button class="btn btn-primary" onclick="showSection('properties'); showPropertyModal()">
                  <i class="fas fa-plus me-2"></i>Add Property
                </button>
                <button class="btn btn-success" onclick="showSection('admins'); showAdminModal()">
                  <i class="fas fa-user-plus me-2"></i>Add Admin
                </button>
                <button class="btn btn-warning" onclick="showSection('users')">
                  <i class="fas fa-user-edit me-2"></i>Manage Users
                </button>
                <button class="btn btn-danger" onclick="showSection('images'); showImageModal()">
                  <i class="fas fa-images me-2"></i>Add Media
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Properties Section -->
    <div id="properties" class="section">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h4><i class="fas fa-building me-2"></i>Properties Management</h4>
        <button class="btn btn-primary" onclick="showPropertyModal()">
          <i class="fas fa-plus me-2"></i>Add Property
        </button>
      </div>

      <div class="card">
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-striped">
              <thead>
              <tr>
                <th>ID</th>
                <th>Image</th>
                <th>Title</th>
                <th>Category</th>
                <th>Price</th>
                <th>Area</th>
                <th>Status</th>
                <th>Created</th>
                <th>Actions</th>
              </tr>
              </thead>
              <tbody id="propertiesTable">
              <!-- Dynamic content -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Users Section -->
    <div id="users" class="section">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h4><i class="fas fa-users me-2"></i>Users Management</h4>
      </div>

      <div class="card">
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-striped">
              <thead>
              <tr>
                <th>ID</th>
                <th>Full Name</th>
                <th>Username</th>
                <th>Phone</th>
                <th>Admin</th>
                <th>Status</th>
                <th>Created</th>
                <th>Actions</th>
              </tr>
              </thead>
              <tbody id="usersTable">
              <!-- Dynamic content -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Admins Section -->
    <div id="admins" class="section">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h4><i class="fas fa-user-shield me-2"></i>Admins Management</h4>
        <button class="btn btn-primary" onclick="showAdminModal()">
          <i class="fas fa-plus me-2"></i>Add Admin
        </button>
      </div>

      <div class="card">
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-striped">
              <thead>
              <tr>
                <th>ID</th>
                <th>Email</th>
                <th>User</th>
                <th>Status</th>
                <th>Created</th>
                <th>Actions</th>
              </tr>
              </thead>
              <tbody id="adminsTable">
              <!-- Dynamic content -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Locations Section -->
    <div id="locations" class="section">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h4><i class="fas fa-map-marker-alt me-2"></i>Locations Management</h4>
      </div>

      <div class="card">
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-striped">
              <thead>
              <tr>
                <th>ID</th>
                <th>Address</th>
                <th>Coordinates</th>
                <th>Property</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
              </thead>
              <tbody id="locationsTable">
              <!-- Dynamic content -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Ratings Section -->
    <div id="ratings" class="section">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h4><i class="fas fa-star me-2"></i>Ratings Management</h4>
      </div>

      <div class="card">
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-striped">
              <thead>
              <tr>
                <th>ID</th>
                <th>Stars</th>
                <th>User</th>
                <th>Status</th>
                <th>Created</th>
                <th>Actions</th>
              </tr>
              </thead>
              <tbody id="ratingsTable">
              <!-- Dynamic content -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Images Section -->
    <div id="images" class="section">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h4><i class="fas fa-images me-2"></i>Media Management</h4>
        <button class="btn btn-primary" onclick="showImageModal()">
          <i class="fas fa-plus me-2"></i>Add Media
        </button>
      </div>

      <div class="card">
        <div class="card-body">
          <div class="row" id="mediaGrid">
            <!-- Dynamic content -->
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modals -->
<!-- Admin Modal -->
<div class="modal fade" id="adminModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Add/Edit Admin</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="adminForm">
          <input type="hidden" id="adminId">
          <div class="mb-3">
            <label class="form-label">Email</label>
            <input type="email" class="form-control" id="adminEmail" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Password</label>
            <input type="password" class="form-control" id="adminPassword" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Select User</label>
            <select class="form-control" id="adminUserId">
              <option value="">Select User</option>
            </select>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary" onclick="saveAdmin()">
          Save Admin
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Property Modal -->
<div class="modal fade" id="propertyModal" tabindex="-1">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Add/Edit Property</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="propertyForm">
          <input type="hidden" id="propertyId">
          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">Title</label>
              <input type="text" class="form-control" id="propertyTitle" required>
            </div>
            <div class="col-md-6 mb-3">
              <label class="form-label">Type</label>
              <input type="text" class="form-control" id="propertyType">
            </div>
          </div>
          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">Category</label>
              <select class="form-control" id="propertyCategory">
                <option value="APARTMENT">Apartment</option>
                <option value="OFFICE">Office</option>
                <option value="COMMERCIAL">Commercial</option>
              </select>
            </div>
            <div class="col-md-6 mb-3">
              <label class="form-label">Price ($)</label>
              <input type="number" class="form-control" id="propertyPrice" step="0.01">
            </div>
          </div>
          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">Area (m²)</label>
              <input type="number" class="form-control" id="propertyArea" step="0.1">
            </div>
            <div class="col-md-6 mb-3">
              <div class="form-check mt-4">
                <input class="form-check-input" type="checkbox" id="depositRequired">
                <label class="form-check-label">Deposit Required</label>
              </div>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary" onclick="saveProperty()">
          Save Property
        </button>
      </div>
    </div>
  </div>
</div>

<!-- User Edit Modal -->
<div class="modal fade" id="userModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Edit User Status</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="userForm">
          <input type="hidden" id="userId">
          <div class="mb-3">
            <label class="form-label">Full Name</label>
            <input type="text" class="form-control" id="userFullName" readonly>
          </div>
          <div class="form-check mb-3">
            <input class="form-check-input" type="checkbox" id="userIsAdmin">
            <label class="form-check-label">Admin User</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="userIsActive">
            <label class="form-check-label">Active User</label>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary" onclick="saveUser()">
          Save Changes
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Image Modal -->
<div class="modal fade" id="imageModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Add Media</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="imageForm">
          <div class="mb-3">
            <label class="form-label">Select Property</label>
            <select class="form-control" id="imagePropertyId">
              <option value="">Select Property</option>
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label">Media Files</label>
            <input type="file" class="form-control" id="imageFiles" multiple accept="image/*,video/*">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary" onclick="saveImages()">
          Upload Media
        </button>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // Sample data with audit fields
  let properties = [
    {
      id: 1,
      title: "Luxury Apartment in Tashkent Center",
      type: "Apartment",
      category: "APARTMENT",
      price: 1200.00,
      area: 85.5,
      depositRequired: true,
      _active: true,
      createdAt: new Date('2024-01-15').toISOString(),
      updatedAt: new Date('2024-01-20').toISOString(),
      createdBy: "admin",
      updatedBy: "admin"
    },
    {
      id: 2,
      title: "Modern Office Space",
      type: "Office",
      category: "OFFICE",
      price: 2500.00,
      area: 120.0,
      depositRequired: false,
      _active: true,
      createdAt: new Date('2024-01-10').toISOString(),
      updatedAt: new Date('2024-01-18').toISOString(),
      createdBy: "admin",
      updatedBy: "admin"
    }
  ];

  let users = [
    {
      id: 1,
      fullName: "John Doe",
      username: "johndoe",
      phone: "+998901234567",
      isAdmin: true,
      _active: true,
      createdAt: new Date('2024-01-01').toISOString(),
      updatedAt: new Date('2024-01-15').toISOString(),
      createdBy: "system",
      updatedBy: "admin"
    },
    {
      id: 2,
      fullName: "Jane Smith",
      username: "janesmith",
      phone: "+998907654321",
      isAdmin: false,
      _active: true,
      createdAt: new Date('2024-01-05').toISOString(),
      updatedAt: new Date('2024-01-10').toISOString(),
      createdBy: "system",
      updatedBy: "admin"
    }
  ];

  let admins = [
    {
      id: 1,
      email: "admin@lionestate.com",
      password: "********",
      userId: 1,
      _active: true,
      createdAt: new Date('2024-01-01').toISOString(),
      updatedAt: new Date('2024-01-15').toISOString(),
      createdBy: "system",
      updatedBy: "admin"
    }
  ];

  let locations = [
    {
      id: 1,
      address: "Tashkent, Yunusabad district, Amir Temur street 15",
      latitude: 41.2995,
      longitude: 69.2401,
      _active: true,
      propertyId: 1,
      createdAt: new Date('2024-01-15').toISOString(),
      updatedAt: new Date('2024-01-20').toISOString(),
      createdBy: "admin",
      updatedBy: "admin"
    }
  ];

  let ratings = [
    {
      id: 1,
      stars: 5,
      userId: 1,
      _active: true,
      createdAt: new Date('2024-01-20').toISOString(),
      updatedAt: new Date('2024-01-20').toISOString(),
      createdBy: "system",
      updatedBy: "system"
    }
  ];

  let images = [
    {
      id: 1,
      url: "/placeholder.svg?height=200&width=300",
      propertyId: 1,
      _active: true,
      createdAt: new Date('2024-01-15').toISOString(),
      updatedAt: new Date('2024-01-15').toISOString(),
      createdBy: "admin",
      updatedBy: "admin"
    }
  ];

  // Toast notification function
  function showToast(message, type = 'success') {
    const toastContainer = document.querySelector('.toast-container');
    const toastId = 'toast-' + Date.now();

    const toastHTML = `
                <div class="toast" id="${toastId}" role="alert" aria-live="assertive" aria-atomic="true">
                    <div class="toast-header">
                        <i class="fas fa-${type === 'success' ? 'check-circle text-success' : 'exclamation-circle text-danger'} me-2"></i>
                        <strong class="me-auto">${type === 'success' ? 'Success' : 'Error'}</strong>
                        <button type="button" class="btn-close" data-bs-dismiss="toast"></button>
                    </div>
                    <div class="toast-body">
                        ${message}
                    </div>
                </div>
            `;

    toastContainer.insertAdjacentHTML('beforeend', toastHTML);
    const toast = new bootstrap.Toast(document.getElementById(toastId));
    toast.show();

    // Remove toast element after it's hidden
    document.getElementById(toastId).addEventListener('hidden.bs.toast', function() {
      this.remove();
    });
  }

  // Navigation functions
  function showSection(sectionName) {
    // Close mobile sidebar when navigating
    closeMobileSidebar();

    // Hide all sections
    document.querySelectorAll('.section').forEach(section => {
      section.classList.remove('active');
    });

    // Show selected section
    document.getElementById(sectionName).classList.add('active');

    // Update active nav link
    document.querySelectorAll('.nav-link').forEach(link => {
      link.classList.remove('active');
    });
    event.target.closest('.nav-link').classList.add('active');

    // Load section data
    switch(sectionName) {
      case 'dashboard':
        loadDashboard();
        break;
      case 'properties':
        loadProperties();
        break;
      case 'users':
        loadUsers();
        break;
      case 'admins':
        loadAdmins();
        break;
      case 'locations':
        loadLocations();
        break;
      case 'ratings':
        loadRatings();
        break;
      case 'images':
        loadImages();
        break;
    }
  }

  function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    const mainContent = document.getElementById('mainContent');

    sidebar.classList.toggle('collapsed');
    mainContent.classList.toggle('expanded');
  }

  function toggleMobileSidebar() {
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('sidebarOverlay');

    sidebar.classList.toggle('mobile-open');
    overlay.classList.toggle('show');
  }

  function closeMobileSidebar() {
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('sidebarOverlay');

    sidebar.classList.remove('mobile-open');
    overlay.classList.remove('show');
  }

  // Dashboard functions
  function loadDashboard() {
    document.getElementById('totalProperties').textContent = properties.filter(p => p._active).length;
    document.getElementById('totalUsers').textContent = users.filter(u => u._active).length;
    document.getElementById('totalAdmins').textContent = admins.filter(a => a._active).length;

    const avgRating = ratings.length > 0 ?
            (ratings.reduce((sum, r) => sum + r.stars, 0) / ratings.length).toFixed(1) : '0.0';
    document.getElementById('avgRating').textContent = avgRating;

    // Load recent properties
    const recentProperties = properties.slice(0, 5);
    const tableBody = document.getElementById('recentPropertiesTable');
    tableBody.innerHTML = recentProperties.map(property => `
                <tr>
                    <td>${property.title}</td>
                    <td><span class="badge bg-primary">${property.category}</span></td>
                    <td>$${property.price.toLocaleString()}</td>
                    <td><span class="badge bg-success">${property._active ? 'Active' : 'Inactive'}</span></td>
                </tr>
            `).join('');
  }

  // Properties functions
  function loadProperties() {
    const tableBody = document.getElementById('propertiesTable');
    tableBody.innerHTML = properties.map(property => `
                <tr>
                    <td>${property.id}</td>
                    <td><img src="/placeholder.svg?height=50&width=50" class="property-image" alt="Property"></td>
                    <td>${property.title}</td>
                    <td><span class="badge bg-primary">${property.category}</span></td>
                    <td>$${property.price.toLocaleString()}</td>
                    <td>${property.area} m²</td>
                    <td><span class="badge bg-${property._active ? 'success' : 'danger'}">${property._active ? 'Active' : 'Inactive'}</span></td>
                    <td>${new Date(property.createdAt).toLocaleDateString()}</td>
                    <td>
                        <button class="btn btn-sm btn-primary me-1" onclick="editProperty(${property.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="deleteProperty(${property.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
  }

  function showPropertyModal(propertyId = null) {
    const modal = new bootstrap.Modal(document.getElementById('propertyModal'));

    if (propertyId) {
      const property = properties.find(p => p.id === propertyId);
      if (property) {
        document.getElementById('propertyId').value = property.id;
        document.getElementById('propertyTitle').value = property.title;
        document.getElementById('propertyType').value = property.type;
        document.getElementById('propertyCategory').value = property.category;
        document.getElementById('propertyPrice').value = property.price;
        document.getElementById('propertyArea').value = property.area;
        document.getElementById('depositRequired').checked = property.depositRequired;
      }
    } else {
      document.getElementById('propertyForm').reset();
      document.getElementById('propertyId').value = '';
    }

    modal.show();
  }

  function saveProperty() {
    const id = document.getElementById('propertyId').value;
    const propertyData = {
      title: document.getElementById('propertyTitle').value,
      type: document.getElementById('propertyType').value,
      category: document.getElementById('propertyCategory').value,
      price: parseFloat(document.getElementById('propertyPrice').value),
      area: parseFloat(document.getElementById('propertyArea').value),
      depositRequired: document.getElementById('depositRequired').checked,
      _active: true,
      updatedAt: new Date().toISOString(),
      updatedBy: "admin"
    };

    if (id) {
      const index = properties.findIndex(p => p.id === parseInt(id));
      if (index !== -1) {
        properties[index] = { ...properties[index], ...propertyData };
        showToast('Property updated successfully!');
      }
    } else {
      const newId = Math.max(...properties.map(p => p.id), 0) + 1;
      properties.push({
        id: newId,
        ...propertyData,
        createdAt: new Date().toISOString(),
        createdBy: "admin"
      });
      showToast('Property added successfully!');
    }

    bootstrap.Modal.getInstance(document.getElementById('propertyModal')).hide();
    loadProperties();
    loadDashboard();
  }

  function editProperty(id) {
    showPropertyModal(id);
  }

  function deleteProperty(id) {
    if (confirm('Are you sure you want to delete this property?')) {
      const index = properties.findIndex(p => p.id === id);
      if (index !== -1) {
        properties[index]._active = false;
        properties[index].updatedAt = new Date().toISOString();
        properties[index].updatedBy = "admin";
        showToast('Property deleted successfully!');
      }
      loadProperties();
      loadDashboard();
    }
  }

  // Users functions
  function loadUsers() {
    const tableBody = document.getElementById('usersTable');
    tableBody.innerHTML = users.map(user => `
                <tr>
                    <td>${user.id}</td>
                    <td>${user.fullName}</td>
                    <td>${user.username || '-'}</td>
                    <td>${user.phone || '-'}</td>
                    <td><span class="badge bg-${user.isAdmin ? 'warning' : 'secondary'}">${user.isAdmin ? 'Admin' : 'User'}</span></td>
                    <td><span class="badge bg-${user._active ? 'success' : 'danger'}">${user._active ? 'Active' : 'Inactive'}</span></td>
                    <td>${new Date(user.createdAt).toLocaleDateString()}</td>
                    <td>
                        <button class="btn btn-sm btn-primary" onclick="editUser(${user.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
  }

  function editUser(id) {
    const modal = new bootstrap.Modal(document.getElementById('userModal'));

    const user = users.find(u => u.id === id);
    if (user) {
      document.getElementById('userId').value = user.id;
      document.getElementById('userFullName').value = user.fullName;
      document.getElementById('userIsAdmin').checked = user.isAdmin;
      document.getElementById('userIsActive').checked = user._active;
    }

    modal.show();
  }

  function saveUser() {
    const id = document.getElementById('userId').value;
    const index = users.findIndex(u => u.id === parseInt(id));

    if (index !== -1) {
      users[index].isAdmin = document.getElementById('userIsAdmin').checked;
      users[index]._active = document.getElementById('userIsActive').checked;
      users[index].updatedAt = new Date().toISOString();
      users[index].updatedBy = "admin";
      showToast('User updated successfully!');
    }

    bootstrap.Modal.getInstance(document.getElementById('userModal')).hide();
    loadUsers();
    loadDashboard();
  }

  // Admins functions
  function loadAdmins() {
    const tableBody = document.getElementById('adminsTable');
    tableBody.innerHTML = admins.map(admin => {
      const user = users.find(u => u.id === admin.userId);
      return `
                    <tr>
                        <td>${admin.id}</td>
                        <td>${admin.email}</td>
                        <td>${user ? user.fullName : '-'}</td>
                        <td><span class="badge bg-${admin._active ? 'success' : 'danger'}">${admin._active ? 'Active' : 'Inactive'}</span></td>
                        <td>${new Date(admin.createdAt).toLocaleDateString()}</td>
                        <td>
                            <button class="btn btn-sm btn-primary me-1" onclick="editAdmin(${admin.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-danger" onclick="deleteAdmin(${admin.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `;
    }).join('');
  }

  function showAdminModal(adminId = null) {
    const modal = new bootstrap.Modal(document.getElementById('adminModal'));

    // Populate user dropdown
    const userSelect = document.getElementById('adminUserId');
    userSelect.innerHTML = '<option value="">Select User</option>' +
            users.filter(u => u._active).map(u =>
                    `<option value="${u.id}">${u.fullName} (${u.username})</option>`
            ).join('');

    if (adminId) {
      const admin = admins.find(a => a.id === adminId);
      if (admin) {
        document.getElementById('adminId').value = admin.id;
        document.getElementById('adminEmail').value = admin.email;
        document.getElementById('adminUserId').value = admin.userId;
        document.getElementById('adminPassword').value = '';
      }
    } else {
      document.getElementById('adminForm').reset();
      document.getElementById('adminId').value = '';
    }

    modal.show();
  }

  function saveAdmin() {
    const id = document.getElementById('adminId').value;
    const adminData = {
      email: document.getElementById('adminEmail').value,
      password: document.getElementById('adminPassword').value,
      userId: parseInt(document.getElementById('adminUserId').value),
      _active: true,
      updatedAt: new Date().toISOString(),
      updatedBy: "admin"
    };

    if (id) {
      const index = admins.findIndex(a => a.id === parseInt(id));
      if (index !== -1) {
        admins[index] = { ...admins[index], ...adminData };
        showToast('Admin updated successfully!');
      }
    } else {
      const newId = Math.max(...admins.map(a => a.id), 0) + 1;
      admins.push({
        id: newId,
        ...adminData,
        createdAt: new Date().toISOString(),
        createdBy: "admin"
      });
      showToast('Admin added successfully!');
    }

    bootstrap.Modal.getInstance(document.getElementById('adminModal')).hide();
    loadAdmins();
    loadDashboard();
  }

  function editAdmin(id) {
    showAdminModal(id);
  }

  function deleteAdmin(id) {
    if (confirm('Are you sure you want to delete this admin?')) {
      const index = admins.findIndex(a => a.id === id);
      if (index !== -1) {
        admins[index]._active = false;
        admins[index].updatedAt = new Date().toISOString();
        admins[index].updatedBy = "admin";
        showToast('Admin deleted successfully!');
      }
      loadAdmins();
      loadDashboard();
    }
  }

  // Locations functions
  function loadLocations() {
    const tableBody = document.getElementById('locationsTable');
    tableBody.innerHTML = locations.map(location => {
      const property = properties.find(p => p.id === location.propertyId);
      return `
                    <tr>
                        <td>${location.id}</td>
                        <td>${location.address}</td>
                        <td>${location.latitude}, ${location.longitude}</td>
                        <td>${property ? property.title : '-'}</td>
                        <td><span class="badge bg-${location._active ? 'success' : 'danger'}">${location._active ? 'Active' : 'Inactive'}</span></td>
                        <td>
                            <button class="btn btn-sm btn-primary" onclick="viewOnMap(${location.latitude}, ${location.longitude})">
                                <i class="fas fa-map-marker-alt"></i>
                            </button>
                        </td>
                    </tr>
                `;
    }).join('');
  }

  function viewOnMap(lat, lng) {
    window.open(`https://www.google.com/maps?q=${lat},${lng}`, '_blank');
  }

  // Ratings functions
  function loadRatings() {
    const tableBody = document.getElementById('ratingsTable');
    tableBody.innerHTML = ratings.map(rating => {
      const user = users.find(u => u.id === rating.userId);
      return `
                    <tr>
                        <td>${rating.id}</td>
                        <td>
                            ${'★'.repeat(rating.stars)}${'☆'.repeat(5 - rating.stars)}
                            <span class="ms-2">(${rating.stars}/5)</span>
                        </td>
                        <td>${user ? user.fullName : 'Unknown'}</td>
                        <td><span class="badge bg-${rating._active ? 'success' : 'danger'}">${rating._active ? 'Active' : 'Inactive'}</span></td>
                        <td>${new Date(rating.createdAt).toLocaleDateString()}</td>
                        <td>
                            <button class="btn btn-sm btn-danger" onclick="deleteRating(${rating.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `;
    }).join('');
  }

  function deleteRating(id) {
    if (confirm('Are you sure you want to delete this rating?')) {
      const index = ratings.findIndex(r => r.id === id);
      if (index !== -1) {
        ratings[index]._active = false;
        ratings[index].updatedAt = new Date().toISOString();
        ratings[index].updatedBy = "admin";
        showToast('Rating deleted successfully!');
      }
      loadRatings();
      loadDashboard();
    }
  }

  // Images functions
  function loadImages() {
    const mediaGrid = document.getElementById('mediaGrid');
    mediaGrid.innerHTML = images.filter(img => img._active).map(image => {
      const property = properties.find(p => p.id === image.propertyId);
      return `
                    <div class="col-lg-3 col-md-4 col-sm-6 mb-3">
                        <div class="card h-100">
                            <img src="${image.url}" class="card-img-top" style="height: 150px; object-fit: cover;" alt="Property Image">
                            <div class="card-body">
                                <h6 class="card-title">${property ? property.title : 'No Property'}</h6>
                                <small class="text-muted d-block mb-2">Created: ${new Date(image.createdAt).toLocaleDateString()}</small>
                                <button class="btn btn-sm btn-danger w-100" onclick="deleteImage(${image.id})">
                                    <i class="fas fa-trash me-2"></i>Delete
                                </button>
                            </div>
                        </div>
                    </div>
                `;
    }).join('');
  }

  function showImageModal() {
    const modal = new bootstrap.Modal(document.getElementById('imageModal'));

    // Populate property dropdown
    const propertySelect = document.getElementById('imagePropertyId');
    propertySelect.innerHTML = '<option value="">Select Property</option>' +
            properties.filter(p => p._active).map(p =>
                    `<option value="${p.id}">${p.title}</option>`
            ).join('');

    modal.show();
  }

  function saveImages() {
    const propertyId = document.getElementById('imagePropertyId').value;
    const files = document.getElementById('imageFiles').files;

    if (!propertyId || files.length === 0) {
      showToast('Please select a property and at least one file', 'error');
      return;
    }

    // Simulate file upload
    for (let i = 0; i < files.length; i++) {
      const newId = Math.max(...images.map(img => img.id), 0) + 1;
      images.push({
        id: newId + i,
        url: `/placeholder.svg?height=200&width=300&text=${files[i].name}`,
        propertyId: parseInt(propertyId),
        _active: true,
        createdAt: new Date().toISOString(),
        updatedAt: new Date().toISOString(),
        createdBy: "admin",
        updatedBy: "admin"
      });
    }

    showToast(`${files.length} media file(s) uploaded successfully!`);
    bootstrap.Modal.getInstance(document.getElementById('imageModal')).hide();
    loadImages();
  }

  function deleteImage(id) {
    if (confirm('Are you sure you want to delete this image?')) {
      const index = images.findIndex(img => img.id === id);
      if (index !== -1) {
        images[index]._active = false;
        images[index].updatedAt = new Date().toISOString();
        images[index].updatedBy = "admin";
        showToast('Image deleted successfully!');
      }
      loadImages();
    }
  }

  // Initialize dashboard on page load
  document.addEventListener('DOMContentLoaded', function() {
    loadDashboard();
  });

  // Handle window resize
  window.addEventListener('resize', function() {
    if (window.innerWidth > 768) {
      closeMobileSidebar();
    }
  });
</script>
</body>
</html>